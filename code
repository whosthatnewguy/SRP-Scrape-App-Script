



function myFunction() {
  var CSE = "";
  var KEY = "";
  var params = {muteHttpExceptions: true};
  var urls = [];


  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var s = ss.getSheetByName('Sheet1');
  var urlRange = s.getRange(1,3,s.getLastRow(),1).getValues();
 
  for(i=0;i<=urlRange.length-1;i++){
    var activeUrl = urlRange[i][0];
    var api = "https://www.googleapis.com/customsearch/v1?key=" + KEY + "&cx=" + CSE + "&q=" + encodeURIComponent(activeUrl);
    Logger.log(api);

    try{
      
      var response = UrlFetchApp.fetch(api,{muteHttpExceptions: true});
      

      if(response.getResponseCode()==200){
        var content = JSON.parse(response);

        if(content.searchInformation.totalResults >0){
          var count = content.items.length;

          for(var i=0;i < count;i++){
            var adding = (content.items[i].link);
            Logger.log(content.items[i].snippet);
            urls.push(adding);
          }
          
        }
        var writeRange = s.getRange(1,4);
    writeRange.setValue(urls);
          Logger.log(urls)
      }
      }catch(err){};

}
}

function concat(location, terms){
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var s = ss.getSheetByName('Sheet1');

  //var location = s.getRange(1,1, s.getLastRow(),1).getValues();
  //var terms = s.getRange(1,2, s.getLastRow(),1).getValues();

  for (i=0;i<=location.length;i++){
    Logger.log(location[i] + " " + terms[i]);
  }

  
}
